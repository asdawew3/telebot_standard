{% extends "base.html" %}

{% set show_navbar = false %}

{% block title %}ç³»ç»Ÿé”™è¯¯ - Telegram Botç®¡ç†ç³»ç»Ÿ{% endblock %}

{% block page_title %}ç³»ç»Ÿé”™è¯¯{% endblock %}

{% block extra_css %}
<style>
/* é”™è¯¯é¡µé¢ç‰¹æ®Šæ ·å¼ */
body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.header {
    display: none;
}

.container {
    max-width: 600px;
    padding: 0;
}

.error-container {
    background-color: #1e1e1e;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    padding: 30px;
    text-align: center;
}

.error-code {
    font-size: 72px;
    color: #f44336;
    margin-bottom: 20px;
    font-weight: bold;
}

.error-title {
    font-size: 24px;
    font-weight: 500;
    margin-bottom: 15px;
    color: #ffffff;
}

.error-message {
    font-size: 16px;
    margin-bottom: 30px;
    color: #aaaaaa;
    line-height: 1.5;
}

.error-details {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #333;
    font-size: 14px;
    color: #666666;
}

.error-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
    opacity: 0.1;
}

#error-particles {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
}

.particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: #f44336;
    border-radius: 50%;
    animation: float 10s infinite linear;
}

@keyframes float {
    0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    90% {
        opacity: 1;
    }
    100% {
        transform: translateY(-100vh) rotate(360deg);
        opacity: 0;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="error-container">
    <div class="error-code" id="error-code">
        {% if error_code == '404' %}
        404
        {% elif error_code == '403' %}
        403
        {% elif error_code == '500' %}
        500
        {% elif error_code == 'PERMISSION_DENIED' %}
        ğŸš«
        {% elif error_code == 'INTERNAL_ERROR' %}
        âš ï¸
        {% else %}
        ERROR
        {% endif %}
    </div>
    
    <h1 class="error-title" id="error-title">
        {% if error_code == '404' %}
        é¡µé¢æœªæ‰¾åˆ°
        {% elif error_code == '403' %}
        è®¿é—®è¢«æ‹’ç»
        {% elif error_code == '500' %}
        å†…éƒ¨æœåŠ¡å™¨é”™è¯¯
        {% elif error_code == 'PERMISSION_DENIED' %}
        æƒé™ä¸è¶³
        {% elif error_code == 'INTERNAL_ERROR' %}
        ç³»ç»Ÿå†…éƒ¨é”™è¯¯
        {% else %}
        ç³»ç»Ÿé”™è¯¯
        {% endif %}
    </h1>
    
    <div class="error-message" id="error-message">
        {{ error_message or 'å‘ç”ŸæœªçŸ¥é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚' }}
    </div>
    
    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
        <a href="javascript:history.back()" class="btn btn-secondary">è¿”å›ä¸Šé¡µ</a>
        <a href="{{ url_for('index') }}" class="btn btn-primary">è¿”å›é¦–é¡µ</a>
        {% if current_user and current_user.is_authenticated %}
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">æ§åˆ¶å°</a>
        {% else %}
        <a href="{{ url_for('login_page') }}" class="btn btn-secondary">é‡æ–°ç™»å½•</a>
        {% endif %}
    </div>
    
    {% if error_code %}
    <div class="error-details">
        <p>é”™è¯¯ä»£ç : {{ error_code }}</p>
        <p style="font-size: 12px;">å¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜</p>
    </div>
    {% endif %}
</div>

<!-- é”™è¯¯èƒŒæ™¯æ•ˆæœ -->
<div class="error-background">
    <div id="error-particles"></div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// é”™è¯¯é¡µé¢ç²’å­æ•ˆæœ
function createErrorParticles() {
    const container = document.getElementById('error-particles');
    if (!container) return;
    
    // åˆ›å»º20ä¸ªç²’å­
    for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        
        // éšæœºä½ç½®å’ŒåŠ¨ç”»å»¶è¿Ÿ
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 10 + 's';
        particle.style.animationDuration = (Math.random() * 5 + 5) + 's';
        
        container.appendChild(particle);
    }
}

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    createErrorParticles();
    
    // è‡ªåŠ¨è®°å½•é”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°
    console.error('é¡µé¢é”™è¯¯:', {
        code: '{{ error_code or "UNKNOWN" }}',
        message: '{{ error_message or "å‘ç”ŸæœªçŸ¥é”™è¯¯" }}',
        url: window.location.href,
        timestamp: new Date().toISOString()
    });
});
</script>
{% endblock %}